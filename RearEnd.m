function F = RearEnd(x,a_k, b_k,c_k,d_k, t_0, t_f, p_0, p_f, v_0, v_f, phi,gamma)

F(1) = (x(1)*t_0^3)/6 + (x(2)*t_0^2)/2 + x(3)*t_0 + x(4) - p_0;
F(2) = (x(1)*t_0^2)/2 + x(2)*t_0 + x(3) - v_0;
F(3) =(x(5)*t_f^3)/6 + (x(6)*t_f^2)/2 + x(7)*t_f + x(8) - p_f;
F(4) =(x(5)*t_f^2)/2 + x(6)*t_f + x(7) - v_f;
F(5) =x(4) - x(8) + x(3)*x(10) - x(7)*x(10) + (x(1)*x(10)^3)/6 + (x(2)*x(10)^2)/2 - (x(5)*x(10)^3)/6 - (x(6)*x(10)^2)/2;
F(6) =x(3) - x(7) + x(2)*x(10) - x(6)*x(10) + (x(1)*x(10)^2)/2 - (x(5)*x(10)^2)/2;
F(7) =x(1) - x(9) - x(5);
F(8) =x(6) - x(2) - x(9)*phi - x(1)*x(10) + x(5)*x(10);
F(9) =- x(2)^2/2 + x(6)^2/2 + x(1)*x(3) - x(5)*x(7);
F(10) = x(9) + (x(2) + x(1)*x(10))^2/(2*x(2) + 2*x(2)*x(10) + x(1)*x(10)^2 + 2*phi*(x(2) + x(1)*x(10)));
F(11)=x(4) - d_k + gamma + x(3)*x(10) - c_k*x(10) + phi*((x(1)*x(10)^2)/2 + x(2)*x(10) + x(3)) + (x(1)*x(10)^3)/6 - (a_k*x(10)^3)/6 + (x(2)*x(10)^2)/2 - (b_k*x(10)^2)/2;





