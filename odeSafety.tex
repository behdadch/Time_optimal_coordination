% This LaTeX was auto-generated from MATLAB code.
% To make changes, update the MATLAB code and export to LaTeX again.

\documentclass{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{graphicx}
\usepackage{color}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{epstopdf}
\usepackage{matlab}

\sloppy
\epstopdfsetup{outdir=./}
\graphicspath{ {./odeSafety_images/} }

\begin{document}

\begin{matlabcode}
clear;
clc; 
syms u(t) a b phi e_i
eqn = diff(u,t)== (-1/phi)*u+(1/phi)*(a*t+b)
\end{matlabcode}
\begin{matlabsymbolicoutput}
eqn(t) = 
    $\displaystyle \frac{\partial }{\partial t}\;u\left(t\right)=\frac{b+a t}{\varphi }-\frac{u\left(t\right)}{\varphi }$
\end{matlabsymbolicoutput}
\begin{matlabcode}
uSolved = dsolve(eqn)
\end{matlabcode}
\begin{matlabsymbolicoutput}
uSolved = 
    $\displaystyle b-a \varphi +a t+C_5  e^{-\frac{t}{\varphi }} $
\end{matlabsymbolicoutput}
\begin{matlabcode}
vSolved = int(uSolved,t)+e_i;
pSolved = int(vSolved);
syms C1 C2 mu_s(t)
eqn2Modified = diff(mu_s,t) == (1/phi)*(mu_s + C2) + (1/phi^2)*(uSolved - (a*t+b));
\end{matlabcode}
\begin{matlabsymbolicoutput}
eqn2Modified(t) = 
    $\displaystyle \frac{\partial }{\partial t}\;\mu_s \left(t\right)=\frac{C_2 +\mu_s \left(t\right)}{\varphi }-\frac{a \varphi -C_5  e^{-\frac{t}{\varphi }} }{\varphi^2 }$
\end{matlabsymbolicoutput}
\begin{matlabcode}
muSolved = dsolve(eqn2Modified);
\end{matlabcode}
\begin{matlabsymbolicoutput}
muSolved = 
    $\displaystyle C_6  e^{t/\varphi } -e^{t/\varphi }  {\left(e^{-\frac{t}{\varphi }}  {\left(C_2 -a\right)}+\frac{C_5  e^{-\frac{2 t}{\varphi }} }{2 \varphi }\right)}$
\end{matlabsymbolicoutput}
\begin{matlabcode}
simplify(muSolved)
\end{matlabcode}
\begin{matlabsymbolicoutput}
ans = 
    $\displaystyle -\frac{2 C_2  \varphi -2 a \varphi +C_5  e^{-\frac{t}{\varphi }} -2 C_6  \varphi  e^{t/\varphi } }{2 \varphi }$
\end{matlabsymbolicoutput}
\begin{matlabcode}
syms lambda_v(t)

eqn3 = diff(lambda_v,t) == -C2-muSolved
\end{matlabcode}
\begin{matlabsymbolicoutput}
eqn3(t) = 
    $\displaystyle \frac{\partial }{\partial t}\;\lambda_v \left(t\right)=e^{t/\varphi }  {\left(e^{-\frac{t}{\varphi }}  {\left(C_2 -a\right)}+\frac{C_5  e^{-\frac{2 t}{\varphi }} }{2 \varphi }\right)}-C_2 -C_6  e^{t/\varphi } $
\end{matlabsymbolicoutput}
\begin{matlabcode}
lambdaSolved = dsolve(eqn3)
\end{matlabcode}
\begin{matlabsymbolicoutput}
lambdaSolved = 
    $\displaystyle C_7 -a t-\frac{C_5  e^{-\frac{t}{\varphi }} }{2}-C_6  \varphi  e^{t/\varphi } $
\end{matlabsymbolicoutput}
\begin{matlabcode}
simplify(lambdaSolved)
\end{matlabcode}
\begin{matlabsymbolicoutput}
ans = 
    $\displaystyle C_7 -a t-\frac{C_5  e^{-\frac{t}{\varphi }} }{2}-C_6  \varphi  e^{t/\varphi } $
\end{matlabsymbolicoutput}
\begin{matlabcode}

simplify(lambdaSolved-muSolved*phi-uSolved)
\end{matlabcode}
\begin{matlabsymbolicoutput}
ans = 
    $\displaystyle C_7 -b+C_2  \varphi -2 a t-C_5  e^{-\frac{t}{\varphi }} -2 C_6  \varphi  e^{t/\varphi } $
\end{matlabsymbolicoutput}

\end{document}
